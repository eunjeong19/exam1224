{{> layout/top}}

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
        function add_ok(){ // 데이터 등록 ajax
            var obj = {"name":$("#name").val(),"title":$("#title").val(), "content":$("#content").val()};
            $.ajax({
                url:"/api/boards",
                type:"POST",
                contentType:"application/json; charset=utf-8",
                data: JSON.stringify(obj),
                dataType:"json",
                success:function(data){
                    // alert(data.title+data.content);
                    var res = "<tr>";
                        res += "<td class='col-1'>"+data.id+"</td>";
			            res += "<td class='col-2'>"+data.name+"</td>";
                        res += "<td class='col-3'><a href='/board/info/"+data.id+"'>"+data.title+"</a></td>";
                        res += "<td class='col-4'><a href='/board/edit?id="+data.id+"'>"+data.content+"</a></td>";
                        res += "</tr>";
                    $("#list").append(res);
			        $("#name").val("");
                    $("#title").val("");
                    $("#content").val("");
                }, error : function(xhr){
                    alert(xhr.status);
                    const error = JSON.parse(xhr.responseText);
                    alert(error.message);
                }
            });
      }
    </script>
</head>
<body>

<div class="container my-5 py-5" style="max-width: 800px;">
    <div class="text-center mb-5">
        <div class="badge bg-primary-subtle text-primary mb-2">New Post</div>

        <h1 class="fw-bold"> 새 글 작성하기 </h1>
        <p class="text-muted">나누고 싶은 소식을 전해주세요.</p>
        <hr class="my-4 mx-auto" style="width: 60px; border-top:3px solid #0d6efd;">
    </div>

    <div class="card shadow-sm border-0 p-4 p-md-5 bg-light rounded-4">
        <div class="card-body">

        <div class="mb-4">
            <label for="name" class="form-label fw-bold"><i class="bi bi-person-fill me-1"></i>작성자</label>
            <input type="text" name="name" id="name" value="{{user.name}}"
                   class="form-control border-0 shadow-sm bg-body-secondary" readonly style="cursor:not-allowed;">
            <div class="form-text small ps-1">회원 전용 게시판으로 성함은 자동으로 등록됩니다.</div>
        </div>

        <div class="mb-4">
            <label for="title" class="form-label fw-bold"><i class="bi bi-pencil-square me-1"></i>제목</label>
            <input type="text" name="title" id="title" class="form-control border-0 shadow-sm p-3"
                   placeholder="제목을 입력하세요">
        </div>

        <div class="mb-4">
            <label for="content" class="form-label fw-bold"><i class="bi bi-card-text me-1"></i>내용</label>
            <textarea name="content" id="content" row="8" class="form-control border-0 shadow-sm p-3"
                      placeholder="내용을 입력해주세요."></textarea>
        </div>

        <div class="text-center mt-5">
            <button type="button" class="btn btn-primary btn-lg px-5 shadow-sm fw-bold" onclick="add_ok();">
                <i class="bi bi-send-fill me-2"></i> Ajax로 글 등록하기
            </button>
            <div class="mt-3">
                <a href="/board" class="text-decoration-none small text-secondary">
                    작성 취소하고 목록으로 돌아가기
                </a>
        </div>
        </div>

        </div>
    </div>
</div>
{{> layout/bottom}}